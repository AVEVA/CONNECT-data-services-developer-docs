---
uid: AssetRules
---
# Asset Rules

Asset rules create assets based on stream properties (such as ID, Name, Description, and stream metadata).  Asset rules are executed on streams in the following ways:

- On-demand execution &ndash; an asset rule is defined and created and it is applied to all existing applicable streams
- Unattended execution &ndash; all asset rules are run whenever a stream is created, updated, or deleted.

The asset rules API allows you to programmatically create, read, update, and delete asset rules.

#### Example Asset Rule

```
{
   "Id":"sampleID",
   "Name":"sampleName",
   "Description":"sampleDescription",
   "AutomationId":"sampleAutomationID",
   "Expressions":[
      {
         "Field":"Id",
         "Specifications":[
            {
               "Type":"Group",
               "Name":"streamId"
            }
         ]
      },
      {
         "Field":"Name",
         "Specifications":[
            {
               "Type":"Group",
               "Name":"location",
               "ValueMappings":{
                  "SL":"San leandro",
                  "AUS":"Austin"
               }
            },
            {
               "Type":"Delimiter",
               "Value":"."
            },
            {
               "Type":"Literal",
               "Value":"test"
            }
         ]
      }
   ],
   "Outputs":[
      {
         "Field":"Asset",
         "Value":{
            "Id":"assetId",
            "Name":"assetName",
            "Description":"this is an asset generated by an asset rule",
            "Metadata":[
               {
                  "Id":"streamId",
                  "Name":"streamName",
                  "Description":"this is an asset attribute",
                  "SdsTypeCode":"18",
                  "Value":"{location}"
               }
            ],
            "References":[
               {
                  "Id":"streamRefName",
                  "Description":"this is a stream reference",
                  "StreamId":"{streamId}"
               }
            ]
         }
      }
   ]
}

```
## Properties

| Property Name | Type                 | Required? | Description                                                  |
| ------------- | -------------------- | --------- | ------------------------------------------------------------ |
| ID            | String               | Required  | An identifier for the asset rule.                            |
| Name          | String               | Optional  | Name of the rule. If left empty, the name defaults to the ID. |
| Description   | String               | Optional  | Description of the asset rule.                               |
| Automation Id | String               | Required  | Reference to the automation ID object whose permissions are used during rule execution. |
| Expressions   | Rule Expression List | Optional  | List of expressions that captures values from stream properties. |
| Outputs       | Rule Output List     | Required  | List of potential outputs of rules. For asset rules, this is a list of assets. |

## Rule Expressions

Rule expressions are objects used to define how stream properties are parsed to create assets. Rule expressions have the following properties:

- Fields &ndash; strings  that determine which stream property to look at for specifications
- Specifications  &ndash; objects that define specifications of a segment in a pattern. Refer to [Specification Types][xref:AssetRules#specification-types]  and [Specification Objects][xref:AssetRules#specification-objects] for a description.

### Specification Types

| Specification | Description                                                  |
| ------------- | ------------------------------------------------------------ |
| Wildcard      | Any remaining characters or strings in a stream property. There can be only one wildcard type in a specification. |
| Group         | Collection of characters that include only specified delimiters. |
| Literal       | A hard-coded string. Only stream properties with a specified literal are captured by a rule. |
| Delimiter     | A specific string that interacts with groups. A group must specify a delimiter to use. |

### Specification Objects

| Property Name      | Type       | Required? | Description                                                  |
| ------------------ | ---------- | --------- | ------------------------------------------------------------ |
| Type               | String     | Required  | A specification type.                                        |
| Value              | String     | Optional  | Required only for the iteral and delimiter specification types.<br />Specifies the text and delimiter values. |
| Name               | String     | Optional  | Required only for the group and wildcard specification types. <br />Specifies the name of the extracted group used in the asset output. |
| CharacterType      | String     | Optional  | Required only for the group specification type.<br />Specified whether the specification allows Any, letters, and digits. If not specified, the default is Any. <!-- Are "Any", "letters", and "digits" the actual values they use? Paul: Yes, that is correct. Only the casing is inconsistent with the code since all are capitalized. The enum is at:L https://dev.azure.com/osieng/engineering/_git/ocs-metadata-rules?path=%2Fsrc%2FOSIsoft.Rules.Models%2FCharacterTypeEnum.cs-->|
| CharacterLength    | Integer    | Optional  | Required only for the group specification type.<br />Specifies the length of characters expected to be extracted by the group. If not specified, it defaults to the longest string length of the group. |
| RequiredDelimiters | Array      | Optional  | Required only for the group specification type.<br />Sequence of required delimiters within a group. If specified, each delimiter within the array must appear in the exact order and number within the group. If not specified, the default value is an empty array. |
| ValueMappings      | Dictionary | Optional  | Required only for the group and wildcard specification types.<br />A collection of mapped values for each group. If not specified, the default is null. |

### Asset Output Objects

| Property Name | Type         | Required? | Description                                                  |
| ------------- | ------------ | --------- | ------------------------------------------------------------ |
| Field         | String       | Required  | The only supported value is *Asset*.                         |
| Value         | Asset Object | Required  | The definition of the asset that is generated or updated with additional fields when a stream matches the rule criteria. `Asset Id` is required. All other properties supported in an asset  (Name, Description, Metadata, References) are optional. All fields can be specified as a combination of literal values and captured values (for example, Pump{pumpNumber} where {pumpNumber} is defined in a specification). Multiple rules or streams can modify a single asset, with each contributing one or more properties to the rule. During execution, assets are created if they do not exist, and, otherwise, properties are appended to existing assets. |

## JSON Paths

JSON paths can be used to retrieve stream metadata and stream type properties. The following are examples of JSON paths.
Note: RegEx in JSON path is not supported in the `Field` specification.

Retrieve stream metadata values 

```
{
    "Field": "Metadata['key']",
    "Specifications": 
            [
                {
                    "Type": "Group",
                    "Name": "value"
                }
            ]
}
```

Retrieve UoM of the stream property type

```
{
    "Field": "Type.Properties[?(@.Id == 'Value')].Uom",
    "Specifications": 
            [
                {
                    "Type": "Group",
                    "Name": "valueUom"
                }
            ]
}
```
